<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="SelfSchedule.DbOption.Mapper.TaskInstanceMapper">
    <select id="getReminderIds" resultType="java.lang.Long">
        select instanceId from TaskInstance i join TaskReminder r on i.instanceId = r.taskId
        where i.taskId=(select taskId from TaskInstance where instanceId=#{taskId} limit 1)
            and r.mode = #{mode} and r.value = #{value}
    </select>

    <select id="getRepeatIdsUnder" resultType="java.lang.Long">
        select i.instanceId from Task t join TaskInstance i on i.instanceId = t.id and i.instanceId!=i.taskId where
            i.taskId = #{taskId} and (t.beginTime &gt;= #{timeLimit} or t.endTime &gt;= #{timeLimit})
    </select>
</mapper>